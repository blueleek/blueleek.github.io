---
layout: post
title:  "电商订单系统设计 - 模块梳理（一）"
categories: 产品设计
tags: 产品
author: blueleek
---
 

 &emsp;&emsp; 这篇文章调研了电商订单系统设计思路，将模块功能进行了梳理总结。主要内容参考了人人都是产品经理社区相关文章，进行了总结归纳。引用出处如下：





 >本文内容原引用于：
 ><br/>
 >[订单系统：从0到1设计思路](http://www.woshipm.com/pd/1392102.html)
 ><br/>
 >[3个方面解析：电商订单系统设计](http://www.woshipm.com/pd/1055272.html)
 
  
 &emsp;&emsp; 订单系统在电商业务中是最常见的模块之一，是经济交易双方是否履约的证明。因此，订单系统在电商生态中起着尤为重要的作用。本文梳理了订单系统中的核心功能和主要流程与大家进行讨论。



<br/>

## 订单系统设计
&emsp;&emsp; 设计系统前先进行模块拆解，将模块功能梳理清晰，确保流程完整性和可扩展性。这里将订单系统拆解为「订单字段」、「订单流程」和「订单推送」三个模块进行梳理。

<br/>

### 订单字段

订单页面上的信息都由单元字段组合而成。

<br/>

<div style="text-align: center">
<img width = "700" src="https://img-blog.csdnimg.cn/20200717140501148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hodGh3eA==,size_16,color_FFFFFF,t_70"/>
</div>

<br/>

***「商品信息」***：商品信息属于订单系统的上游，所有订单都基于商品生成，订单系统必须搜集相关的商品信息，包括店铺信息、商品 ID、商品规格、商品数量、商品价格。

***「用户信息」***：用户信息包括购买用户的 ID、收货人、收货地址、联系方式。有些平台的用户成长体系是基于用户对平台的活跃度来计算的，例如京东，它有会员等级及积分卡等类似的成长标识，此时获取用户信息除了普通信息字段外，还需要获取该用户的等级，该次购买后所获得的积分，以及用户所在等级能在该订单上扣除的优惠信息，具体怎么操作取决于公司的业务方向。

***「支付信息」***：支付信息中包含商品金额、优惠金额、支付金额。优惠金额中涉及的信息比较复杂，像有自营和第三方入驻的电商平台，都会有商家优惠和跨店优惠，这些优惠又分为不同类型，例如现金扣减、消费券扣减、积分获取、礼品卡扣减，或者以上几种组合的使用。需要充分了解公司的业务情况，保证流程的完整性。

***「时间信息」***：记录各个卡点时间。一是历史记录，二是方便售后验证客户和客户分析。订单时间是根据订单状态改变而改变，比如我们常见的：
<br/>
<br/>
「下单未付款」：订单创建时间、下单时间；
<br/>
「待发货状态」：展示订单创建时间、下单时间、支付时间；
<br/>
「待收货状态」：展示订单创建时间、下单时间、支付时间、发货时间；
<br/>
「交易完成状态」：展示订单创建时间、下单时间、支付时间、发货时间、完成时间；
<br/>
「交易关闭-用户取消」：展示订单创建时间、下单时间、用户取消时间；
<br/>
「交易关闭-仅退款」：订单创建时间、下单时间、支付时间、退款申请时间、退款成功时间；
<br/>
「交易关闭-退货退款」：订单创建时间、下单时间、支付时间、交易完成时间、申请退款时间、退款时间。

<br/>

***「订单信息」***：
订单信息在订单系统最为核心，订单信息最重要的又是订单状态，将订单的流转可视化，是订单状态机的一种呈现形式，而它实质上就是在描述订单状态的转换。

<br/>

<div style="text-align: center">
<img width = "480" height="660" src="https://img-blog.csdnimg.cn/20200717150659137.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hodGh3eA==,size_16,color_FFFFFF,t_70"/>
</div>

<br/>


### 订单流程

订单流程指的是从订单生成到完成整个流转的过程，其中包括正向流程和逆向流程。

订单在多系统间流转图：
<div style="text-align: center">
<img width = "700" src="https://img-blog.csdnimg.cn/20200717154640697.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hodGh3eA==,size_16,color_FFFFFF,t_70"/>
</div>

<br/>

#### 正向流程：

正向流程就是一个正常网购的步骤，订单生成-> 订单支付 -> 订单生产 -> 订单确认 -> 交易完成。

<br/>

<div style="text-align: center">
<img width = "480" height = "500" src="https://img-blog.csdnimg.cn/20200717170843484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hodGh3eA==,size_16,color_FFFFFF,t_70"/>
</div>

<br/>

***「订单创建」***：用户下单之后，系统需要生成订单，此时需要先获取下单中涉及的商品信息，然后获取该商品所涉及的优惠信息，如果商品不参与优惠信息，则无此环节。

接着会获取该账户的会员权益

增减库存规则，目前存在两种主流方式：


**1. 下单减库存 - 即用户下单成功时减少库存数量**

**优势**：用户体验友好，系统逻辑简洁；

**缺点**：会导致恶意下单或下单后却不买，使得真正有需求的用户无法购买，影响真实销量。

**解决办法**：
+ 设置订单有效时间，若订单创建成功 N 分钟不付款，则订单取消，库存回滚
+ 限购，用各种条件来限制买家的购买件数，比如一个账号、一个ip，只能买一件
+ 风控，从技术角度进行判断，屏蔽恶意账号，禁止恶意账号购买。


**2. 付款减少库存 - 即用户下单成功时减少库存数量**

**优势**：减少无效订单带来的资源损耗；

**缺点**：因第三方支付返回结果存在时差，同一时间多个用户同时付款成功，会导致下单数目超过库存，商家库存不足容易引发断货和投诉，成本增加。

**解决办法**：
+ 付款前再次校验库存，如确定要付款再验证一次，并友好提示库存不足
+ 增加提示信息：在商品详情页，订单步骤提示不及时付款，不能保证有库存

**总结**：综上所述，两个方案各有优缺点，需要结合具体场景进行考虑，如：抢购、秒杀、促销活动可使用下单减库存的方式。对于产品库存量大，并发流量没那么强的产品使用付款减库存的方式。

<br/>

**「订单支付」**：用户支付完订单后，需要获取订单的信息，包括支付流水账号，支付时间等。支付完订单接着就是等商家发货，但在发货的过程中，根据平台业务模式的不同可能会涉及订单的拆分。

订单拆分一般分两种：
+ 一种是用户挑选的商品来自不同渠道（自营与商家，商家与商家）
+ 另一种是在 SKU 层面上拆分订单：不同仓库，不同运输要求的SKU，包裹重量体积限制等因素都需要将订单拆分。
比如：商品 A 只在甲仓库有，商品 B 又只在乙仓库有，此时会将商品 A 与商品 B 拆分成两个订单。或者有些企业的做法是将商品 A/B 调拨到另外一个仓库统一发货，也方便了用户。


订单拆单看起来简单，其实里面涉及到底层的系统支持，如你需要对每一个仓库的货品进行相对准确的盘点，且做到实时同步（涉及到仓库精细化管理），对商品进行准确分类与摆放，对商品信息记录准确无误等。



**「订单生产」**：
产品从企业到用户这一流程的概述。如电商平台中，商家发货过程有一个标准化的流程，订单内容会发送到仓库，仓库对商品进行打单、拣货、包装、快递交接。这里不做详细讨论。

**「订单确认」**：收到货后，订单系统需要在快递被签收后提醒用户对商品做评价。这里要注意确认收到货不代表交易成功，相反是售后服务的开始。

**「订单完成」**：订单完成是指在收到货 X 天的状态，此时订单不在售后的支持时间范围内。到此，一个订单的正向流程就算走完了。


#### 逆向流程：

<br/>

<div style="text-align: center">
<img width = "700" src="https://img-blog.csdnimg.cn/20200717173448584.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hodGh3eA==,size_16,color_FFFFFF,t_70"/>
</div>

<br/>

**「订单修改」**：
可梳理订单内信息，根据信息关联程度及业务诉求，设置订单可修改的范围是，比如：客户下单后，想修改收货人地址及电话，此时，只需对应数据更新即可。

**「订单取消」**：
用户提交订单时，在跳转至支付前直接退出，此时用户原则上属于取消订单，因为还未付款，只需将原本提交订单时扣减的库存补回，促销优惠券中使用优惠券，权益等视为平台规则，进行相应的补回。

**「支付失败」**：
用户进行支付时退出，或者取消支付，我们将其列为支付失败状态，此时处理同上，将扣减的库存补回可销售库存即可。

**「付款后退款」**：
用户支付成功之后，商家还未发货，客户发出退款诉求，需要商户进行退款审核，双方达成一致后，系统应以退款单的形式完成退款，关联原订单数据。因商品无变化，所以不需考虑与库存系统的交互，仅需考虑促销系统及支付系统交互即可。

如果仓库与客服是分离的，则需要先检查仓库是否已经发货，若已发货则应与客户沟通是否可以收到货后再进行退款，如果仓库还未发货，则可以直接同意用户退款。或者企业可以接入物流，实行截件功能，不过这种操作还不成熟，成本会比较大，不适合中小创业型公司。

**「缺货退款」**：
用户支付成功后，商家发货时发现仓库缺货（仓库管理商品时没办法做到 100% 精准，所以信息有时候会不准确），则需要与用户协商是否退款。


**「待收货退款」**：这个问题目前还没有特别完美的解决方法，商家发货之后，用户还未收到货，此时货在路上。主要有两种解决方式

**方式一：「用户收到货后重新寄回」**：

**优势**：
+ 保护商家利益。用户未收到货退款一般与商品质量无关，允许用户直接拒收，商家则需要承担回退运费，而本身可能与商家无太大关系。
+ 商家发货地址与退货地址不在同一个地方，不支持直接退回。

**劣势**：对用户不太友好，需要用户收货后退回

<br/>

**方式二：「用户拒收包裹，包裹直接退回原地址」**

**优势**：用户体验友好

**劣势**：对商家不友好，无法确保商家收发货地址一致

<br/>

**「用户拒收」**：同上

**「退货退款」**：
用户收到货后，想要申请售后，则此时需要让用户输入售后原因（包括上传凭证的功能），如果与商家协商无果，还需要增加平台客服的入口，方便用户进行申诉。而协商/申诉成功后直接触发自动退款机制，退款后触发消息通知，同时触发交易关闭，整个售后过程结束。


**「用户拒收」**：同上




### 订单推送
订单推送的作用是当订单状态机发生变化时，需要将对应的变化情况告知相关人员以便了解当前订单的情况。

订单推送的触发依赖于状态机的改变，涉及到的信息包括：

+ 推送对象（用户、商家、仓库）；
+ 推送方式（站内消息、push、短信、微信）；
+ 推送节点（状态机）；
+ 本文主讲订单系统的核心模块设计逻辑，订单推送的具体设计就不再此处赘述。


这篇文章主要调研了电商订单系统设计思路，将模块功能进行了梳理，下一篇文章将以需求文档的形式输出，详述系统目标及各模块的功能。

<br/>

**我是蓝韭菜，一个热爱思考产品逻辑的程序员，喜欢阅读各类书籍和写作。**

扫描下面二维码，关注海派甜心老韭菜，不要犹豫，关注起来吧。<br/>
<div style="text-align: center">
<img src="https://pic1.zhimg.com/80/v2-e9a8c6db60c6ed251ad46fa464063dac_hd.jpg"/>
</div>

